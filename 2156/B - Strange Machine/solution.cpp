#include <bits/stdc++.h>using namespace std; #define ll long long void solve(){    // LOGIC    ll n, q;    cin >> n >> q;     string s;    cin >> s;     vector<ll> v(q);    ll m = 0;    bool div = (s.find('B') != string::npos);    for(int i = 0; i< q; i++){ cin >> v[i]; m = max(m, v[i]); }       // vector<ll> arr(m + 1, -1);     for(int i = 0; i < q; i++){        ll c = 0;        ll cur = v[i];        int j = 0;        if(!div){            cout << v[i] << endl;        }        else{        while(cur != 0){            // if(arr[cur] != -1) {            //     c += arr[cur];            //     break;            // }            if(s[j] == 'A') cur--;            else cur/= 2;            j++;            j %= n;            c++;            // arr[cur] = c;            // cout << "q " << cur <<  " ";        }        cout << c << endl;        // arr[v[i]] = c;    }    } } int main(){    ios::sync_with_stdio(false); // Fast I/O    cin.tie(nullptr);            // Untie cin from cout     int n;    cin >> n;    while(n--) solve();}