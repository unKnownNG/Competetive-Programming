<h3><a href="https://codeforces.com/contest/2146/problem/C" target="_blank" rel="noopener noreferrer">Wrong Binary Search</a></h3>

<div class="header"><div class="title">C. Wrong Binary Search</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file input-standard"><div class="property-title">input</div>standard input</div><div class="output-file output-standard"><div class="property-title">output</div>standard output</div></div><div><p>  </p><p>You are given an integer $$$n$$$ and a binary string$$$^{\text{∗}}$$$ $$$s$$$ of length $$$n$$$.</p><p>For a permutation$$$^{\text{†}}$$$ $$$p$$$ of length $$$n$$$ and an integer $$$x$$$, we define $$$\text{find}(x)$$$ as in the following pseudocode:</p><pre class="lstlisting"><code class="prettyprint prettyprinted" style=""><span class="kwd">function</span><span class="pln"> find</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">):</span><br><span class="pln">    l </span><span class="pun">:=</span><span class="pln"> </span><span class="lit">1</span><br><span class="pln">    r </span><span class="pun">:=</span><span class="pln"> n</span><br><span class="pln">    </span><span class="kwd">while</span><span class="pln"> l </span><span class="pun"><=</span><span class="pln"> r</span><span class="pun">:</span><br><span class="pln">        </span><span class="kwd">let</span><span class="pln"> m be a random integer between l </span><span class="kwd">and</span><span class="pln"> r </span><span class="pun">(</span><span class="pln">inclusive</span><span class="pun">)</span><br><span class="pln">        </span><span class="kwd">if</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">m</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> x</span><br><span class="pln">            </span><span class="kwd">return</span><span class="pln"> m</span><br><span class="pln">        </span><span class="kwd">if</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">m</span><span class="pun">]</span><span class="pln"> </span><span class="pun">></span><span class="pln"> x</span><span class="pun">:</span><br><span class="pln">            r </span><span class="pun">:=</span><span class="pln"> m </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><br><span class="pln">        </span><span class="kwd">else</span><span class="pun">:</span><br><span class="pln">            l </span><span class="pun">:=</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><br><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">undefined</span><span class="pln">     </span><span class="com">// not found</span><br></code></pre><p>We call an integer $$$x$$$ ($$$1\le x\le n$$$) <span class="tex-font-style-it">stable</span> if and only if $$$\text{find}(x)$$$ is <span class="tex-font-style-bf">always</span> not undefined and $$$p_{\text{find}(x)}=x$$$ <span class="tex-font-style-bf">always</span> holds, no matter how the value of $$$m$$$ is selected in the process of the pseudocode.</p><p>You have to construct a permutation $$$p$$$ of length $$$n$$$, such that:</p><ul> <li> For each $$$1\le i\le n$$$, the integer $$$i$$$ is <span class="tex-font-style-it">stable</span> <span class="tex-font-style-bf">if and only if</span> $$$s_i=\mathtt{1}$$$. </li></ul><p>Or determine that no such permutation exists.</p><div class="statement-footnote"><p>$$$^{\text{∗}}$$$A binary string is a string where each character is either $$$\mathtt{0}$$$ or $$$\mathtt{1}$$$.</p><p>$$$^{\text{†}}$$$A permutation of length $$$n$$$ is an array consisting of $$$n$$$ distinct integers from $$$1$$$ to $$$n$$$ in arbitrary order. For example, $$$[2,3,1,5,4]$$$ is a permutation, but $$$[1,2,2]$$$ is not a permutation ($$$2$$$ appears twice in the array), and $$$[1,3,4]$$$ is also not a permutation ($$$n=3$$$ but there is $$$4$$$ in the array). </p></div></div><div class="input-specification"><div class="section-title">Input</div><p>Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \le t \le 10^4$$$). The description of the test cases follows. </p><p>The first line of each test case contains a single integer $$$n$$$ ($$$2\le n \le 2\cdot 10^5$$$) — the length of the permutation.</p><p>The second line contains the binary string $$$s$$$ of length $$$n$$$ ($$$s_i=\mathtt{0}$$$ or $$$\mathtt{1}$$$).</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$2\cdot 10^5$$$. </p></div><div class="output-specification"><div class="section-title">Output</div><p>For each test case:</p><ul> <li> If no such permutation exists, print "<span class="tex-font-style-tt">NO</span>" in the only line of output. </li><li> Otherwise, print "<span class="tex-font-style-tt">YES</span>" in the first line of output. Then output $$$n$$$ distinct integers $$$p_1, p_2, \ldots, p_n$$$ ($$$1\le p_i\le n$$$) in the second line — the permutation you constructed. </li></ul><p>You can output the token in any case (upper or lower). For example, the strings "<span class="tex-font-style-tt">yEs</span>", "<span class="tex-font-style-tt">yes</span>", "<span class="tex-font-style-tt">Yes</span>", and "<span class="tex-font-style-tt">YES</span>" will be recognized as positive responses.</p><p>If there are multiple answers, you may print any of them.</p></div><div class="sample-tests"><div class="section-title">Example</div><div class="sample-test"><div class="input"><div class="title">Input<div title="Copy" data-clipboard-target="#id007689932399189386" id="id005554461656070139" class="input-output-copier">Copy</div></div><pre id="id007689932399189386"><div class="test-example-line test-example-line-even test-example-line-0">6</div><div class="test-example-line test-example-line-odd test-example-line-1">3</div><div class="test-example-line test-example-line-odd test-example-line-1">111</div><div class="test-example-line test-example-line-even test-example-line-2">5</div><div class="test-example-line test-example-line-even test-example-line-2">00000</div><div class="test-example-line test-example-line-odd test-example-line-3">5</div><div class="test-example-line test-example-line-odd test-example-line-3">10100</div><div class="test-example-line test-example-line-even test-example-line-4">7</div><div class="test-example-line test-example-line-even test-example-line-4">0010000</div><div class="test-example-line test-example-line-odd test-example-line-5">11</div><div class="test-example-line test-example-line-odd test-example-line-5">00001001100</div><div class="test-example-line test-example-line-even test-example-line-6">12</div><div class="test-example-line test-example-line-even test-example-line-6">011100010000</div></pre></div><div class="output"><div class="title">Output<div title="Copy" data-clipboard-target="#id008621443018061932" id="id003159309636761668" class="input-output-copier">Copy</div></div><pre id="id008621443018061932"><div class="test-example-line test-example-line-odd test-example-line-1">YES</div><div class="test-example-line test-example-line-odd test-example-line-1">1 2 3 </div><div class="test-example-line test-example-line-even test-example-line-2">YES</div><div class="test-example-line test-example-line-even test-example-line-2">2 4 3 5 1</div><div class="test-example-line test-example-line-odd test-example-line-3">NO</div><div class="test-example-line test-example-line-even test-example-line-4">YES</div><div class="test-example-line test-example-line-even test-example-line-4">2 1 3 5 7 6 4</div><div class="test-example-line test-example-line-odd test-example-line-5">YES</div><div class="test-example-line test-example-line-odd test-example-line-5">2 1 4 3 5 7 6 8 9 11 10</div><div class="test-example-line test-example-line-even test-example-line-6">NO</div></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test case, we have constructed $$$p=[1,2,3]$$$. Take $$$\text{find(2)}$$$ as an example:</p><ul> <li> In the beginning, $$$l=1$$$ and $$$r=3$$$; </li><li> We will select $$$m$$$ as a random integer between $$$l=1$$$ and $$$r=3$$$. <ul> <li> If we choose $$$m=1$$$: <ul> <li> $$$p_1=1< 2$$$, so $$$l$$$ is set to $$$m + 1 = 2$$$. Now $$$l=2$$$ and $$$r=3$$$; </li><li> We will select $$$m$$$ as a random integer between $$$l=2$$$ and $$$r=3$$$. </li><li> If we choose $$$m=2$$$: $$$p_2=2$$$, so the return value is $$$2$$$. </li><li> If we choose $$$m=3$$$: $$$p_3=3>2$$$, so $$$r$$$ is set to $$$m-1=2$$$. Now $$$l=2$$$ and $$$r=2$$$, so we can only select $$$m=2$$$. $$$p_2=2$$$, so the return value is $$$2$$$. </li></ul> </li><li> If we choose $$$m=2$$$: <ul> <li> $$$p_2=2$$$, so the return value is $$$2$$$. </li></ul> </li><li> If we choose $$$m=3$$$, the process is similar to that when $$$m=1$$$ is chosen. The return value is always $$$2$$$. </li></ul> </li><li> Thus, no matter how $$$m$$$ is selected during the process, the return value of $$$\text{find}(2)$$$ is always $$$2$$$. </li></ul><p>So $$$p_{\text{find}(2)}= p_2 = 2$$$ always holds, and the integer $$$2$$$ is <span class="tex-font-style-it">stable</span>. </p><p>Similarly, we can show that integers $$$1$$$ and $$$3$$$ are also <span class="tex-font-style-it">stable</span>. Thus, the permutation $$$p = [1, 2, 3]$$$ is a valid answer.</p><p>In the second test case, we have constructed $$$p=[2,4,3,5,1]$$$. Take $$$\text{find(3)}$$$ as an example: </p><ul> <li> In the beginning, $$$l=1$$$ and $$$r=5$$$; </li><li> We will select $$$m$$$ as a random integer between $$$l=1$$$ and $$$r=5$$$. Let's choose $$$m=2$$$; </li><li> $$$p_2=4>3$$$, so $$$r$$$ is set to $$$m-1=1$$$. Now $$$l=1$$$ and $$$r=1$$$; </li><li> We will select $$$m$$$ as a random integer between $$$l=1$$$ and $$$r=1$$$. We can only choose $$$m=1$$$; </li><li> $$$p_1=2<3$$$, so $$$l$$$ is set to $$$m + 1 = 2$$$. Now $$$l=2$$$ and $$$r=1$$$; </li><li> Since $$$l>r$$$, the loop is exited and the return value is undefined. </li></ul><p>Thus, the return value of $$$\text{find}(3)$$$ is undefined, so the integer $$$3$$$ is not <span class="tex-font-style-it">stable</span>.</p><p>Similarly, we can show that integers $$$1$$$, $$$2$$$, $$$4$$$, and $$$5$$$ are also not <span class="tex-font-style-it">stable</span>. Thus, $$$p = [2, 4, 3, 5, 1]$$$ is a valid answer.</p><p>Some other permutations, such as $$$p=[5,4,3,2,1]$$$ and $$$p=[3,5,1,4,2]$$$, are also valid answers. You may print any of them.</p><p>In the third test case, it can be proven that no such permutation exists.</p></div>